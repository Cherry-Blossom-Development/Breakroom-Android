how to set up window 11 to build android apps using claude code

Below is a practical, Windows-11‚Äìspecific setup guide to build Android apps using Claude Code as your AI coding assistant. This assumes you want Claude to help write, refactor, and reason about your Android project while you build locally.

1. Prerequisites (Windows 11)

  A. Enable WSL 2 (Recommended)

    1. Claude Code works best in a Unix-like environment.
    2. Open PowerShell (Admin)

       Run:

         wsl --install

    3. Reboot when prompted
    4. Install Ubuntu 22.04 from Microsoft Store if not installed automatically

       Verify:

         wsl --status

2. Install Core Android Tooling

  A. Java (JDK 17 ‚Äì required for modern Android)

    Inside Ubuntu (WSL):

      sudo apt update
      sudo apt install openjdk-17-jdk -y


    Verify:

      java -version

  B. Android Studio (Windows)

     Install Android Studio for Windows (recommended to keep emulator stable).

     During setup, ensure:
       ‚úÖ Android SDK
       ‚úÖ Android SDK Platform Tools
       ‚úÖ Android Emulator

     After install, open Android Studio once and:

       Install API 34
       Install Build Tools
       Create an emulator (Pixel 7 is fine)

   C. Share Android SDK with WSL

      Android SDK is usually here:

        C:\Users\<you>\AppData\Local\Android\Sdk

      Expose it to WSL by adding to ~/.bashrc:

        export ANDROID_HOME=/mnt/c/Users/<you>/AppData/Local/Android/Sdk
        export PATH=$PATH:$ANDROID_HOME/platform-tools
        export PATH=$PATH:$ANDROID_HOME/tools

      Reload:

        source ~/.bashrc

      Verify:

        adb version

3. Install Claude Code (Anthropic)

  A. Install Node.js (WSL)

    curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
    sudo apt install nodejs -y

    Verify:

      node -v
      npm -v

  B. Install Claude Code CLI

    npm install -g @anthropic-ai/claude-code

    Authenticate:

      claude login

    (You‚Äôll be prompted for your Anthropic API key)

  4. Create an Android Project

    Option A: Android Studio (Recommended)

    1. Create a New Android Project
    2. Choose Empty Activity
    3. Language: Kotlin
    4. Minimum SDK: API 24+

    Project location example:

      C:\Users\<you>\AndroidStudioProjects\MyApp

    Access it in WSL:

      cd /mnt/c/Users/<you>/AndroidStudioProjects/MyApp

  5. Use Claude Code for Android Development

    Start Claude inside your project

      claude

      Claude now understands:
      * Your Gradle files
      * Kotlin source
      * AndroidManifest.xml
      * Project structure

    Example Prompts (Very Important)

    Generate UI

      Create a Jetpack Compose screen with a login form,
      email + password validation, and Material 3 styling.

    Architecture

      Refactor this app to MVVM with ViewModel, StateFlow,
      and a repository layer.
 
    Debugging

      Analyze this crash log and explain why the app crashes
      when rotating the device.

    Gradle Fixes

      Fix Gradle build errors and update dependencies to
      Android Gradle Plugin 8+.

    API Integration

      Add Retrofit + Hilt + Kotlin Serialization for a REST API.

  6. Running & Debugging

    Emulator

    Run emulator from Android Studio (Windows)

    Then in WSL:

      adb devices

    Build from WSL

      ./gradlew assembleDebug

    Install APK

      adb install app/build/outputs/apk/debug/app-debug.apk

  7. Best Practices When Using Claude Code

    Do ‚úÖ
      * Ask Claude to modify existing files
      * Ask for diff-style changes
      * Ask for tests (JUnit + Compose UI tests)
      * Ask for performance improvements

    Avoid ‚ùå
      * Letting Claude blindly upgrade all dependencies
      * Asking it to ‚Äúrewrite everything‚Äù without constraints

  8. Optional Enhancements

    Git Integration

      sudo apt install git -y
      git init

    Claude can now:

      Review my uncommitted changes and suggest improvements.

    Lint & Formatting

      Ask Claude to:

        Configure ktlint and detekt for this project.

Summary Architecture

Windows 11
‚îú‚îÄ‚îÄ Android Studio (UI, Emulator)
‚îú‚îÄ‚îÄ WSL Ubuntu
‚îÇ   ‚îú‚îÄ‚îÄ JDK 17
‚îÇ   ‚îú‚îÄ‚îÄ Android SDK (shared)
‚îÇ   ‚îú‚îÄ‚îÄ Gradle
‚îÇ   ‚îî‚îÄ‚îÄ Claude Code CLI
‚îî‚îÄ‚îÄ Claude AI (design, code, debug)


If you want, I can:
  * Generate a Claude prompt template for Android
  * Set up Hilt + Compose + Navigation
  * Optimize Claude Code for large Android projects
  * Help you build a real app (step by step)

Just tell me your app idea or stack.

I said:

PS C:\WINDOWS\system32> wsl --install
Downloading: Ubuntu
Installing: Ubuntu
A distribution with the supplied name already exists. Use --name to chose a different name.
Error code: Wsl/InstallDistro/Service/RegisterDistro/ERROR_ALREADY_EXISTS
PS C:\WINDOWS\system32> wsl --status
Default Distribution: docker-desktop
Default Version: 2
PS C:\WINDOWS\system32> sudo apt update
Sudo is disabled on this machine. To enable it, go to the Developer Settings page in the Settings app
PS C:\WINDOWS\system32> sudo apt update
Command not found
PS C:\WINDOWS\system32> wsl --status
Default Distribution: docker-desktop
Default Version: 2
PS C:\WINDOWS\system32> sudo apt update
Command not found
PS C:\WINDOWS\system32>

You‚Äôre very close üëç ‚Äî the issue is not an error, it‚Äôs just a context mix-up between PowerShell, WSL, and Docker Desktop.

Let me explain what‚Äôs happening and then give you exact steps to fix it.

What‚Äôs going on (important)

  1. You are currently in Windows PowerShell

    PS C:\WINDOWS\system32>

    ‚Üí This is not Linux
    ‚Üí sudo and apt do not exist here

  2. Your default WSL distro is docker-desktop

    Default Distribution: docker-desktop

    ‚Üí This is a minimal internal distro
    ‚Üí It does not have apt, sudo, or a normal shell
    ‚Üí You should NOT use it for Android development

  3. Ubuntu is already installed, but:

     * It is not the default
     * You are not inside it

Goal

  You need:
  ‚úÖ A real Ubuntu WSL distro
  ‚úÖ Enter that distro
  ‚úÖ Use sudo apt ... inside Ubuntu, not PowerShell

Step 1: List installed WSL distros

  Run this in PowerShell:

    wsl --list --verbose

  You should see something like:

    NAME              STATE           VERSION
    Ubuntu            Stopped         2
    docker-desktop    Running         2

Step 2: Start Ubuntu explicitly

  In PowerShell, run:

    wsl -d Ubuntu

  Your prompt should change to something like:

    yourname@DESKTOP-XXXX:~$

    üëâ This means you are now inside Linux

Step 3: Update Ubuntu (this will now work)

  Inside Ubuntu (NOT PowerShell):

    sudo apt update

  If prompted:

    Enter your Ubuntu password (typing is invisible ‚Äî this is normal)

Step 4: Make Ubuntu the default WSL distro (recommended)

  Back in PowerShell:

    wsl --set-default Ubuntu

  Verify:

    wsl --status

  Expected:

    Default Distribution: Ubuntu
    Default Version: 2

  Now when you run:

    wsl

    ‚Üí it will open Ubuntu automatically.

Step 5: (Optional) Ignore the ‚Äúsudo is disabled‚Äù Windows message

  This message:

    Sudo is disabled on this machine...

  ‚ùå Only applies to Windows sudo
  ‚úÖ Does NOT affect WSL

  You can safely ignore it.

Why Docker Desktop caused confusion

  Docker Desktop installs:
    * docker-desktop
    * docker-desktop-data

  These are:
    * Not full Linux distros
    * Not suitable for development
    * Missing package managers

  Never run Android or Claude tooling in docker-desktop.

What to do next (once Ubuntu works)

  Inside Ubuntu:

    sudo apt install openjdk-17-jdk -y

  Then we‚Äôll:
    * Install Node.js
    * Install Claude Code
    * Connect Android SDK
    * Build your Android app

Quick sanity check

  Reply with the output of:

    whoami
    lsb_release -a

  That will confirm you‚Äôre in the correct Ubuntu environment, and I‚Äôll guide you to the next step.


I said:

wsl --list --verbose
  NAME              STATE           VERSION
* docker-desktop    Stopped         2
  Ubuntu            Stopped         2
PS C:\WINDOWS\system32> wsl -d Ubuntu
WSL2 is not supported with your current machine configuration.
Please enable the "Virtual Machine Platform" optional component and ensure virtualization is enabled in the BIOS.
Enable "Virtual Machine Platform" by running: wsl.exe --install --no-distribution
For information please visit https://aka.ms/enablevirtualization
Error code: Wsl/Service/CreateInstance/CreateVm/HCS/HCS_E_HYPERV_NOT_INSTALLED

Perfect, thanks for the exact output ‚Äî this makes the problem 100% clear now üëç
You are hitting a host configuration issue, not a WSL or Ubuntu issue.

Root Cause (Plain English)

Your machine supports WSL, Ubuntu is installed, BUT:

  ‚ùå Hardware virtualization is not enabled
  ‚ùå Windows ‚ÄúVirtual Machine Platform‚Äù feature is not enabled

Because of this:

  WSL cannot start any Linux distro

  Docker Desktop can still exist, but WSL2 cannot actually run Ubuntu

That‚Äôs why you see:

  HCS_E_HYPERV_NOT_INSTALLED

What You Need to Do (2 Required Fixes)

‚úÖ Fix 1: Enable Virtualization in BIOS/UEFI (MOST IMPORTANT)

  You must do this first, or nothing else will work.

  Steps (general ‚Äî wording varies by manufacturer):

  1. Restart your computer

  2. While booting, press one of:

     * DEL
     * F2
     * F10
     * ESC

  3. Enter BIOS / UEFI

  4. Look for one of these settings:

    * Intel Virtualization Technology (VT-x)
    * Intel VT-d
    * SVM Mode (AMD)
    * AMD-V

  5. Set it to:

     Enabled

  6. Save & Exit

üî¥ If this is not enabled, WSL2, Android Emulator, Docker, and Claude workflows will not work.

‚úÖ Fix 2: Enable Windows Virtual Machine Platform

  After rebooting into Windows:

  Option A (Recommended ‚Äì PowerShell as Admin)

    Open PowerShell (Run as Administrator) and run:

      dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
      dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

    Then reboot.

  Option B (GUI)

    1. ress Win + R

    2. Type:

       optionalfeatures

    3. Enable:

       ‚úÖ Virtual Machine Platform

       ‚úÖ Windows Subsystem for Linux

    4. Click OK

    5. Reboot

Step 3: Verify WSL2 Is Now Working

  After reboot, open PowerShell and run:

    wsl --status

  Expected:

    Default Version: 2

  Then try:

    wsl -d Ubuntu

  ‚úÖ You should now enter Ubuntu and see:

    username@DESKTOP-XXXX:~$

Step 4: Make Ubuntu Default (Once It Works)

  wsl --set-default Ubuntu


Why This Matters for Android + Claude

  Without virtualization:

    ‚ùå WSL won‚Äôt run
    ‚ùå Android Emulator won‚Äôt run
    ‚ùå Docker-based tooling breaks
    ‚ùå Claude Code workflow collapses

  With it enabled:

    ‚úÖ WSL Ubuntu works
    ‚úÖ Android Emulator works
    ‚úÖ Gradle builds are fast
    ‚úÖ Claude Code can analyze your project properly

If You Get Stuck in BIOS

  Tell me:
    * Laptop/Desktop brand (Dell, HP, Lenovo, ASUS, etc.)
    * CPU (Intel or AMD)

  I‚Äôll give exact BIOS menu paths for your machine.

  Once Ubuntu opens successfully, I‚Äôll walk you step-by-step into:
    ‚û° installing JDK 17
    ‚û° installing Node.js
    ‚û° installing Claude Code
    ‚û° building your first Android app

You‚Äôre on the right track ‚Äî this is the last Windows hurdle üí™